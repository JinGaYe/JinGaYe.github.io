(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{426:function(t,e,s){},560:function(t,e,s){"use strict";var a=s(426);s.n(a).a},588:function(t,e,s){"use strict";s.r(e);var a=s(17),i=s.n(a),l=s(430),n=s(50),r={name:"Calendar",props:{titleStr:{type:String,default:""},showTimeStr:{type:String,default:""},timeStr:{type:String,default:""}},data(){return{calendar:new Date,visible:!0,showCalendar:!1,monthTasks:{},clickDay:this.$parseTime(new Date,"{y}-{m}-{d}")}},computed:{uid(){return this.$store.state.user.user.uid},update(){return this.$store.state.memory.update},isDev:()=>!1},watch:{showCalendar(t){this.$nextTick(()=>{t?i()("#live2d-widget").css("transform",`translateX(${-(i()(".show-calendar-popover").width()+30)}px)`):i()("#live2d-widget").css("transform","translateX(0px)")})},update(t){t&&(this.getMonthTasks(this.uid),this.$store.dispatch("setUpdate",!1))}},created(){this.isDev&&(this.getMonthTasks(this.uid),this.initOperateButton())},methods:{...Object(n.b)(["openDialogs","closeDialogs","setDate"]),getMonthTasks(t,e=this.$parseTime(new Date,"{y}-{m}")){Object(l.c)({uid:t,month:e}).then(t=>{this.monthTasks=t||{}}).catch(this.$message.error)},getDayStyle(t){if(this.isDev)return Array.isArray(this.monthTasks[t])&&this.monthTasks[t].length?this.monthTasks[t].some(t=>0===t.status)?"unfinish":"finish":"none"},clickWhichDay(t){this.clickDay=t},async showDayTaskDetail(){await Promise.allSettled([this.setDate(this.clickDay),this.openDialogs({key:"memory",visible:!0}),this.closeDialogs({key:"memory",left:0})]),this.showCalendar=!1},clickCalender(t){const e=(t.path||[]).some(t=>t.tagName&&"TD"===t.tagName.toUpperCase()),s=(t.path||[]).some(t=>t.tagName&&"BUTTON"===t.tagName.toUpperCase());e&&(this.clickDay=this.$refs.calendar.realSelectedDay,this.visible=!0),s&&(this.clickDay=this.$refs.calendar.realSelectedDay,this.getMonthTasks(this.uid,this.$parseTime(this.calendar,"{y}-{m}")))},initOperateButton(){this.$nextTick(()=>{this.$refs.calendar.$el.addEventListener("click",this.clickCalender)})}},beforeDestroy(){this.$refs.calendar.$el.removeEventListener("click",this.clickCalender)}},c=(s(560),s(9)),o=Object(c.a)(r,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-popover",{attrs:{placement:"top-start","popper-class":"show-calendar-popover",trigger:"manual"},model:{value:t.showCalendar,callback:function(e){t.showCalendar=e},expression:"showCalendar"}},[s("div",{staticClass:"date-content"},[s("header",[s("p",{staticClass:"title-str"},[t._v(t._s(t.titleStr))]),t._v(" "),s("p",{staticClass:"show-time"},[t._v(t._s(t.showTimeStr))])]),t._v(" "),s("el-calendar",{ref:"calendar",scopedSlots:t._u([{key:"dateCell",fn:function(e){var a=e.data.day;return s("div",{staticClass:"date-cell",class:t.getDayStyle(a)},[s("p",[t._v(t._s(a.slice(a.lastIndexOf("-")+1)))])])}}]),model:{value:t.calendar,callback:function(e){t.calendar=e},expression:"calendar"}}),t._v(" "),s("section",[s("div",{staticClass:"to-do-panel",class:{show:t.visible,hide:!t.visible}},[s("h4",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"center"}},[s("span",[t._v(t._s(t.clickDay.slice(t.clickDay.indexOf("-")+1))+"日程")]),t._v(" "),Array.isArray(t.monthTasks[t.clickDay])&&t.monthTasks[t.clickDay].length?s("el-button",{staticStyle:{color:"#0cc"},attrs:{type:"text"},on:{click:t.showDayTaskDetail}},[t._v("详情")]):t._e()],1),t._v(" "),Array.isArray(t.monthTasks[t.clickDay])&&t.monthTasks[t.clickDay].length?s("ul",{staticClass:"to-do-list"},t._l(t.monthTasks[t.clickDay],(function(e,a){return s("li",{key:e.tid},[s("span",{staticClass:"content"},[t._v(t._s(a+1+". "+e.title))]),t._v(" "),s("span",[s("el-tag",{staticClass:"finished",attrs:{type:1===e.status?"success":"danger",size:"small"}},[t._v("\n                "+t._s(1===e.status?"已完成":"未完成")+"\n              ")])],1)])})),0):s("p",{staticClass:"no-task-tip"},[t._v("暂无设置任务")])]),t._v(" "),s("div",{staticClass:"operate-button"},[s("el-button",{attrs:{type:"text",size:"small",icon:t.visible?"el-icon-arrow-down":"el-icon-arrow-up"},on:{click:function(e){t.visible=!t.visible}}},[t._v(t._s((t.visible?"隐藏":"显示")+"日程"))])],1)])],1),t._v(" "),s("li",{staticClass:"dateString",attrs:{slot:"reference",title:t.showTimeStr},on:{click:function(e){t.showCalendar=!t.showCalendar}},slot:"reference"},[s("span",{staticClass:"time"},[t._v(t._s(t.titleStr.slice(0,t.titleStr.lastIndexOf(":"))))]),t._v(" "),s("span",{staticClass:"date"},[t._v(t._s(t.timeStr))])])])}),[],!1,null,null,null);e.default=o.exports}}]);